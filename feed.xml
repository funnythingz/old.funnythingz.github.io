<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>funnythingz</title>
  <subtitle>てきとうなblogです</subtitle>
  <id>http://www.funnythingz.com</id>
  <link href="http://www.funnythingz.com"/>
  <link href="http://www.funnythingz.com/feed.xml" rel="self"/>
  <updated>2015-04-25T20:40:00+09:00</updated>
  <author>
    <name>Blog Author</name>
  </author>
  <entry>
    <title>Goでの個人開発における本番環境</title>
    <link rel="alternate" href="http://www.funnythingz.com/2015/04/25/plog-production.html"/>
    <id>http://www.funnythingz.com/2015/04/25/plog-production.html</id>
    <published>2015-04-25T20:40:00+09:00</published>
    <updated>2015-04-26T18:19:41+09:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;こんにちは、funnythingzです。Webサービスやスマホアプリの開発とかやってます。&lt;/p&gt;

&lt;p&gt;Goで開発した&lt;a href="http://plog.link"&gt;plog&lt;/a&gt;という匿名ダイアリー的なWebサービスがあるのですが、本番環境をいろいろ変えまくったのでメモがてら残しておきます。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h2&gt;さくらVPS&lt;/h2&gt;

&lt;p&gt;まず最初のリリース時がこの環境です。&lt;/p&gt;

&lt;p&gt;さくらVPSのVPS512プランを契約してGoアプリをFastCGIとしてSupervisorでDaemon化してNginx経由で動かすという構成でした。
GoでつくったWebサービスだとこの構成が一番ポピュラーっぽいです。すべてさくらVPS内でもっていました。&lt;/p&gt;

&lt;p&gt;データベースとか含むとこんな感じの構成です。&lt;/p&gt;

&lt;h3&gt;OS&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;CentOS&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;環境構築&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Chefと手動&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Webサーバー&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Nginx&lt;/li&gt;
&lt;li&gt;FastCGI化したGoアプリ&lt;/li&gt;
&lt;li&gt;Supervisor&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;DB&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;MySQL&lt;/li&gt;
&lt;li&gt;Redis&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;所感&lt;/h3&gt;

&lt;p&gt;ベタな構成なのですが、すべてがVPS上においてあってサーバー構築も時間かかるしセキュリティ面も自分で考えなきゃだし結構いろいろ面倒くさい。&lt;/p&gt;

&lt;p&gt;サーバー構成も忘れやすいし、もしぶっ壊れた場合は復旧が絶対つらいというのが想像できます。運用コスト高いです。&lt;/p&gt;

&lt;h2&gt;DigitalOcean&lt;/h2&gt;

&lt;p&gt;会社でDockerを覚えたのでDocker使うとモテるんじゃないかという下心からとりあえずDocker化してみたいと思いやってみることにしました。
あと&lt;a href="https://twitter.com/akiyan"&gt;あきやん&lt;/a&gt;さんに&lt;a href="https://www.digitalocean.com/?refcode=f40307411b2b"&gt;DigitalOcean&lt;/a&gt;が良いというのをきいたので招待してもらって移行してみました。&lt;/p&gt;

&lt;p&gt;Dockerを使うにあたっては、&lt;a href="https://www.tutum.co/"&gt;tutum.co&lt;/a&gt;ってのがありましてDocker Platformな感じのサービスで、DigitalOceanに良い感じに環境を構築してデプロイまでやってくれるというステキサービスがあるのでtutum.coを使いました。&lt;/p&gt;

&lt;h3&gt;OS&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Ubuntu&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;環境構築&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Docker&lt;/li&gt;
&lt;li&gt;tutum.co&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Webサーバー&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;GoのGoji(コンテナー)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;DB&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;MySQL(コンテナー)&lt;/li&gt;
&lt;li&gt;Redis(コンテナー)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;所感&lt;/h3&gt;

&lt;p&gt;tutum.coがDockerHubみたいになっていてDockerイメージをprivateで管理することができます。ただしDockerを使うためのOSがデフォルトがUbuntuという謎構成だったのがつらいのと、とりあえず動くっちゃ動くのですが、MySQLコンテナーはデータの永続化させようとすると色々面倒くさいのでMySQLをコンテナーにするのはよくないなぁと思いました。&lt;/p&gt;

&lt;p&gt;すべてをDockerのコンテナーとして動かすというのは成功しましたが実際の本番運用はつらいです。&lt;/p&gt;

&lt;p&gt;ちなみにGoアプリをDockerにのっけるやりかたはこちらのスライドをどうぞ&lt;/p&gt;

&lt;script async class="speakerdeck-embed" data-id="d598024a1bda473eb8fcc563ee644d65" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"&gt;&lt;/script&gt;

&lt;h2&gt;DigitalOcean + Google Cloud SQL&lt;/h2&gt;

&lt;p&gt;MySQLはやはり外部にもった方がいろいろ扱いやすいなと思い、AWSのRDSは高いしクラウド破産しかねないので&lt;a href="https://cloud.google.com/products/?hl=ja"&gt;Google Cloud Platform&lt;/a&gt;のサービス、&lt;a href="https://cloud.google.com/sql/?hl=ja"&gt;Cloud SQL&lt;/a&gt;を使うことにしました。&lt;/p&gt;

&lt;p&gt;やっぱりMySQLとかデータ系はそれ専用のサービス使うのが一番良いなって思います。&lt;/p&gt;

&lt;p&gt;そして、 Docker on Ubuntuをやめて、基本のDocker on CoreOSにしました。&lt;/p&gt;

&lt;h3&gt;OS&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;CoreOS&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;環境構築&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Docker&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Webサーバー&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;GoのGoji(コンテナー)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;DB&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;MySQL(Google Cloud SQL)&lt;/li&gt;
&lt;li&gt;Redis(コンテナー)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;所感&lt;/h3&gt;

&lt;p&gt;これでやっと安心して運用できるかなと思いました。スケールアウトはできないですが、そこまでアクティブなサービスではないので妥協しています。&lt;/p&gt;

&lt;h2&gt;まとめ&lt;/h2&gt;

&lt;p&gt;こんな感じでGoで個人開発したものを安く公開できる環境は整ってきていると思うので、Go人口が増えたら良いなぁと思ってます。&lt;/p&gt;

&lt;p&gt;ちなみに&lt;a href="https://www.digitalocean.com/?refcode=f40307411b2b"&gt;こちらからDigitalOceanに登録&lt;/a&gt;すると$10のクーポンがもらえちゃうよ！&lt;/p&gt;

&lt;p&gt;Go、楽しいよ、Go!!&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Androidアプリの開発をはじめました</title>
    <link rel="alternate" href="http://www.funnythingz.com/2015/04/22/android.html"/>
    <id>http://www.funnythingz.com/2015/04/22/android.html</id>
    <published>2015-04-22T23:46:00+09:00</published>
    <updated>2015-04-22T23:54:49+09:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;こんばんは、funnythingzです。何日か更新が止まりました。まさに3日坊主のはじまりです。&lt;/p&gt;

&lt;p&gt;今までWeb系の開発しかしたことなかったのですが、Androidアプリの開発に手を出し始めてみました。とは言ってもまだXMLでレイアウトを書き始めたばかりなのでJavaコードはさわっていません。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;もともとはWebのフロントエンドのエンジニアだったのでマークアップは得意なのですが、AndroidのレイアウトやViewは完全に初めてなのですべてゼロから勉強です。&lt;/p&gt;

&lt;p&gt;&lt;a href="http://plog.link/"&gt;plog&lt;/a&gt;というGoで開発した匿名ダイアリー的なものがあるのですが、これをAndroidアプリ化しようとしています。
グリッドで良い感じに配置したいのでGridViewを使えば良いというところまでは教えてもらったので、良い感じになるように頑張ろうと思います。&lt;/p&gt;

&lt;p&gt;単なるしょぼい決意表明でした。がんばるぞ！&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Footer style</title>
    <link rel="alternate" href="http://www.funnythingz.com/2015/04/19/footer-style.html"/>
    <id>http://www.funnythingz.com/2015/04/19/footer-style.html</id>
    <published>2015-04-19T15:00:00+09:00</published>
    <updated>2015-04-22T23:57:44+09:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;こんぬつは、funnythingzです。3日連続でblogを書いてから日が開いてしまいました。これを3日坊主というらしいです。そうです、まさに3日坊主です。なかなか続ける大変だね！&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;blogは書いていませんでしたが、実はこっそりFooterのStyleを変更していました。ちょっと薄い紫色とアイコンを足してみました。&lt;/p&gt;

&lt;p&gt;そんな感じです。明日から本気だすぞ！&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Androidアプリをつくる前にAPIのインフラ周りを考える</title>
    <link rel="alternate" href="http://www.funnythingz.com/2015/04/16/infra.html"/>
    <id>http://www.funnythingz.com/2015/04/16/infra.html</id>
    <published>2015-04-16T00:46:00+09:00</published>
    <updated>2015-04-22T23:57:26+09:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;突然のこんばんは、funnythingzです。夜です、ねむいです。&lt;/p&gt;

&lt;p&gt;Androidアプリをつくろうと思っているのですが、APIとかどうしようかと思っています。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;APIつくったことなければAndroidアプリもつくったことがなく、インフラもよくわからないしわからないことだらけですが雰囲気でなんとかカバーしようと思っています。&lt;/p&gt;

&lt;p&gt;とりあえずこんな感じのを考えています。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;今をときめくGo&lt;/li&gt;
&lt;li&gt;今をときめくDocker&lt;/li&gt;
&lt;li&gt;Goコンテナー&lt;/li&gt;
&lt;li&gt;MySQLコンテナー&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;APIはこんな感じ。インフラのクラウドサービスはここらへんを使いたいなと。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.digitalocean.com/"&gt;DigitalOcean&lt;/a&gt; &amp;hellip; CoreOS/Docker&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.tutum.co/"&gt;tutum&lt;/a&gt; &amp;hellip; Dockerイメージリポジトリとデプロイとか&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;とりあえずVagrantのCoreOSでGoコンテナーとMySQLコンテナーは雰囲気で動いたので、次はコンテナー上のGoアプリからMySQLコンテナーへ接続してみて良さ気だったら開発で本気出し始めるフェーズに入れるかなと。&lt;/p&gt;

&lt;p&gt;がんばるぞ！&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>design</title>
    <link rel="alternate" href="http://www.funnythingz.com/2015/04/15/design.html"/>
    <id>http://www.funnythingz.com/2015/04/15/design.html</id>
    <published>2015-04-15T00:34:00+09:00</published>
    <updated>2015-04-22T23:56:51+09:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;こんばんは、funnythingzです。雑ですが一瞬でデザインできました。適度に満足です。&lt;/p&gt;

&lt;p&gt;例えばこんな感じ。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;Goもhighlightされちゃう。&lt;/p&gt;
&lt;pre class="highlight go"&gt;&lt;code&gt;&lt;span class="k"&gt;package&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="x"&gt;

&lt;/span&gt;&lt;span class="k"&gt;import&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="x"&gt;
        &lt;/span&gt;&lt;span class="s"&gt;"fmt"&lt;/span&gt;&lt;span class="x"&gt;
&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="x"&gt;

&lt;/span&gt;&lt;span class="k"&gt;func&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="x"&gt;
        &lt;/span&gt;&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Hello world."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="x"&gt;
&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="x"&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;良い感じになった！&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>blogつくりはじめた</title>
    <link rel="alternate" href="http://www.funnythingz.com/2015/04/14/make-blog.html"/>
    <id>http://www.funnythingz.com/2015/04/14/make-blog.html</id>
    <published>2015-04-14T22:22:00+09:00</published>
    <updated>2015-04-22T23:56:33+09:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;こんにちは、funnythingzです。 &lt;code&gt;funnythingz&lt;/code&gt; っていうblogをつくりはじめました。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;だいたいそんなにblogを書きまくるタイプではないのですが、ゆにこさんっていうすごいデザイナーの人がmiddlemanで&lt;a href="http://yuni.co/"&gt;yunicode&lt;/a&gt;っていうステキなblogをつくったので負けじとつくってみることにしました。&lt;/p&gt;

&lt;p&gt;テックブログ的なのは&lt;a href="http://hiropo.co.uk/"&gt;ひろぽっぽれす&lt;/a&gt;というblogをやっているのですが、テックブログってついつい面倒くさくなって書かなくなるので日常的にどうでもいいこととか書けて続くようなblogを始めてみようと思います。&lt;/p&gt;

&lt;p&gt;とりあえずデザインつくるぞ！&lt;/p&gt;
</content>
  </entry>
</feed>
